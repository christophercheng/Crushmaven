<!DOCTYPE html>
<html>
    <head>
		<style type="text/css">
		.navbar .active {
    	font-weight: bold;
		font-color: red;
    	}
    	body {
    		background: url({{ STATIC_URL }}45original.gif) repeat;
    	}
    	</style>
    	
    	<!-- Add Facebook Friend Selector CSS -->
		<link type="text/css" href="{{ STATIC_URL }}friend-selector/jquery.friend.selector-1.2.css" rel="stylesheet" />


		<!-- Add jQuery library 
		<script type="text/javascript" src="http://facebook-friend-selector.codersgrave.com/js/libs/jquery-1.8.3.min.js"></script>-->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		
		<!-- Add Facebook Friend Selector JS -->
		<script type="text/javascript" src="{{ STATIC_URL }}friend-selector/jquery.friend.selector-1.2.js"></script>
    	
		<title>CrushVibes | Anonymous discovery and connect with crushes and secret admirers</title>

    </head>
    <body>
  
 <div id="fb-root"></div>
 <script>
    (function() {
      var e = document.createElement('script'); e.async = true;
          e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
          document.getElementById('fb-root').appendChild(e);
          }());

    window.fbAsyncInit = function() {
      FB.init({ appId: {{facebook_app_id}}, 
      status: true, 
      cookie: true,
      xfbml: true,
      oauth: true}); 
    };
  </script>  

<!--  remove this test comment -->

<script type="text/javascript">
  jQuery(document).ready(function($) {
  $(".bt-fs-dialog").fSelector({ // call the .fSelector function and send it a massive dictionary of option values
	  accessToken: "{{request.user.access_token}}",
	  facebookID: "{{request.user.username}}",
	  malePref:null,// {% if request.user.gender_pref = 'F' %} false {% elif request.user.gender_pref = 'M' %} true {% else %} null{% endif %},
      max:18,
	  excludeIds: "{% for crush_rel in request.user.crush_relationship_set_from_source.all %}{{crush_rel.target_person.username}}{% if not forloop.last %},{% endif %}{% endfor %}",
      closeOverlayClick: true,
      overlayOpacity: "0.3",
      overlayColor: '#000',
      closeOnSubmit: true,
      showSelectedCount: true,
      color: "default",
      showRandom:false,
      lang: {
        title: "Select Your Crushes step 1 of 2",
        buttonSubmit: "Select",
        buttonCancel: "Cancel",
        summaryBoxResult: "{1} best results for {0}",
        summaryBoxNoResult: "No results for {0}",
        searchText: "Enter a friend's name",
        fbConnectError: "Sorry, there is a problem connecting to Facebook's server. Please try again later.",
        selectedCountResult: "You have choosen {0} people.",
        selectedLimitResult: "Limit is {0} people."
      },
      onStart: function(response){ return null },
      onClose: function(response){ return null },
      onSubmit: function(response){
			add_friends_to_db(response);
      }
    });
  });
  
  function add_friends_to_db(response)
  {	      
		// add a special field if the added crushes are open
       // response looks like a comma delimited list of facebook id's
		var form = document.createElement("form");
		form.setAttribute("method", "POST");
		{% if add_as_platonic_friends %}
			form.setAttribute("action", "http://{{request.get_host}}/just_friends/");
		{% else %} 
			form.setAttribute("action", "http://{{request.get_host}}/crushes_in_progress/");
		{% endif %}
		
		var hiddenField;
		var cField;
		cField =	document.createElement("div");
		cField.setAttribute("style","display:none");
		form.appendChild(cField);
		var input_field;
		input_field = document.createElement("input");
		input_field.setAttribute("type", "hidden");
		input_field.setAttribute("name","csrfmiddlewaretoken");
		input_field.setAttribute("value","{{csrf_token}}");
		form.appendChild(input_field);
	
		var	key;
		var id;

		results = String(response).split(',');
		
		for(i=0; i<results.length; i++) 
		{	
			hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            key = "to[" + i + "]";
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", results[i]);
            form.appendChild(hiddenField);
		}
		document.body.appendChild(form);
		form.submit();
		document.body.removeChild(form);
  };
</script>
<script type="text/javascript">
jQuery(document).ready(function($) {
  $(".inactive_crushed_friends").load('/friends_with_admirers_section');

});

</script>
{% if request.path == '/settings_profile/' or request.path == '/settings_notifications/' or request.path == '/settings_credits/' %}
	{% include "navigation_settings.html" %}
{% else %}
	{% include "navigation.html" %}
{% endif %}

{% block content %}
{% endblock %}
		
<hr>
<fb:like></fb:like>
<BR><BR><a href="/admin/">Admin</a><br>
 